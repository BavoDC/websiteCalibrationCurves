<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The function val.prob.ci.2 is an adaptation of val.prob from Frank Harrell's rms package,
https://cran.r-project.org/package=rms. Hence, the description of some of the functions of val.prob.ci.2
come from the the original val.prob.
  The key feature of val.prob.ci.2 is the generation of logistic and flexible calibration curves and related statistics.
When using this code, please cite: Van Calster, B., Nieboer, D., Vergouwe, Y., De Cock, B., Pencina, M.J., Steyerberg,
E.W. (2016). A calibration hierarchy for risk models was defined: from utopia to empirical data. Journal of Clinical Epidemiology,
74, pp. 167-176"><title>Calibration performance — val.prob.ci.2 • CalibrationCurves</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calibration performance — val.prob.ci.2"><meta property="og:description" content="The function val.prob.ci.2 is an adaptation of val.prob from Frank Harrell's rms package,
https://cran.r-project.org/package=rms. Hence, the description of some of the functions of val.prob.ci.2
come from the the original val.prob.
  The key feature of val.prob.ci.2 is the generation of logistic and flexible calibration curves and related statistics.
When using this code, please cite: Van Calster, B., Nieboer, D., Vergouwe, Y., De Cock, B., Pencina, M.J., Steyerberg,
E.W. (2016). A calibration hierarchy for risk models was defined: from utopia to empirical data. Journal of Clinical Epidemiology,
74, pp. 167-176"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CalibrationCurves</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/CalibrationCurves.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calibration performance</h1>
      
      <div class="d-none name"><code>val.prob.ci.2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function <code>val.prob.ci.2</code> is an adaptation of <code>val.prob</code> from Frank Harrell's rms package,
<a href="https://cran.r-project.org/package=rms" class="external-link">https://cran.r-project.org/package=rms</a>. Hence, the description of some of the functions of <code>val.prob.ci.2</code>
come from the the original <code>val.prob</code>.
<br><br> The key feature of <code>val.prob.ci.2</code> is the generation of logistic and flexible calibration curves and related statistics.
When using this code, please cite: Van Calster, B., Nieboer, D., Vergouwe, Y., De Cock, B., Pencina, M.J., Steyerberg,
E.W. (2016). A calibration hierarchy for risk models was defined: from utopia to empirical data. <em>Journal of Clinical Epidemiology</em>,
<b>74</b>, pp. 167-176</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">val.prob.ci.2</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">logit</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  normwt <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pl <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  smooth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loess"</span>, <span class="st">"rcs"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  CL.smooth <span class="op">=</span> <span class="st">"fill"</span>,</span>
<span>  CL.BT <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lty.smooth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col.smooth <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  lwd.smooth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nr.knots <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  logistic.cal <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lty.log <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col.log <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  lwd.log <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Predicted probability"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Observed proportion"</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.02</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.15</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">m</span>,</span>
<span>  <span class="va">g</span>,</span>
<span>  <span class="va">cuts</span>,</span>
<span>  emax.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  legendloc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.27</span><span class="op">)</span>,</span>
<span>  statloc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.85</span><span class="op">)</span>,</span>
<span>  dostats <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cl.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  method.ci <span class="op">=</span> <span class="st">"pepe"</span>,</span>
<span>  roundstats <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  riskdist <span class="op">=</span> <span class="st">"predicted"</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  cex.leg <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  connect.group <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  connect.smooth <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  g.group <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  evaluate <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  nmin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  d0lab <span class="op">=</span> <span class="st">"0"</span>,</span>
<span>  d1lab <span class="op">=</span> <span class="st">"1"</span>,</span>
<span>  cex.d01 <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  dist.label <span class="op">=</span> <span class="fl">0.04</span>,</span>
<span>  line.bins <span class="op">=</span> <span class="op">-</span><span class="fl">0.05</span>,</span>
<span>  dist.label2 <span class="op">=</span> <span class="fl">0.03</span>,</span>
<span>  <span class="va">cutoff</span>,</span>
<span>  las <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  length.seg <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  y.intersp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lty.ideal <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col.ideal <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  lwd.ideal <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  allowPerfectPredictions <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>p</dt>
<dd><p>predicted probability</p></dd>


<dt>y</dt>
<dd><p>vector of binary outcomes</p></dd>


<dt>logit</dt>
<dd><p>predicted log odds of outcome.  Specify either <code>p</code> or <code>logit</code>.</p></dd>


<dt>group</dt>
<dd><p>a grouping variable.  If numeric this variable is grouped into
<code>g.group</code> quantile groups (default is quartiles).  Set <code>group=TRUE</code> to
use the <code>group</code> algorithm but with a single stratum for <code>val.prob</code>.</p></dd>


<dt>weights</dt>
<dd><p>an optional numeric vector of per-observation weights (usually frequencies),
used only if <code>group</code> is given.</p></dd>


<dt>normwt</dt>
<dd><p>set to <code>TRUE</code> to make <code>weights</code> sum to the number of non-missing observations.</p></dd>


<dt>pl</dt>
<dd><p><code>TRUE</code> to plot the calibration curve(s). If <code>FALSE</code> no calibration curves will be plotted,
but statistics will still be computed and outputted.</p></dd>


<dt>smooth</dt>
<dd><p><code>"loess"</code> generates a flexible calibration curve based on <code><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess</a></code>,
<code>"rcs"</code> generates a calibration curves based on restricted cubic splines (see <code><a href="https://rdrr.io/pkg/rms/man/rms.trans.html" class="external-link">rcs</a></code> and
<code><a href="https://rdrr.io/pkg/Hmisc/man/rcspline.plot.html" class="external-link">rcspline.plot</a></code>), <code>"none"</code> suppresses the flexible curve. We recommend to use loess unless N is large,
 for example N&gt;5000. Default is <code>"loess"</code>.</p></dd>


<dt>CL.smooth</dt>
<dd><p><code>"fill"</code> shows pointwise 95% confidence limits for the flexible calibration curve with a gray
area between the lower and upper limits, <code>TRUE</code> shows pointwise 95% confidence limits for the flexible calibration curve
 with dashed lines, <code>FALSE</code> suppresses the confidence limits. Default is <code>"fill"</code>.</p></dd>


<dt>CL.BT</dt>
<dd><p><code>TRUE</code> uses confidence limits based on 2000 bootstrap samples, <code>FALSE</code> uses closed form confidence limits.
Default is <code>FALSE</code>.</p></dd>


<dt>lty.smooth</dt>
<dd><p>the linetype of the flexible calibration curve. Default is <code>1</code>.</p></dd>


<dt>col.smooth</dt>
<dd><p>the color of the flexible calibration curve. Default is <code>"black"</code>.</p></dd>


<dt>lwd.smooth</dt>
<dd><p>the line width of the flexible calibration curve. Default is <code>1</code>.</p></dd>


<dt>nr.knots</dt>
<dd><p>specifies the number of knots for rcs-based calibration curve. The default as well as the highest allowed value is 5.
In case the specified number of knots leads to estimation problems, then the number of knots is automatically reduced to the closest
 value without estimation problems.</p></dd>


<dt>logistic.cal</dt>
<dd><p><code>TRUE</code> plots the logistic calibration curve, <code>FALSE</code> suppresses this curve.
Default is <code>FALSE</code>.</p></dd>


<dt>lty.log</dt>
<dd><p>if <code>logistic.cal=TRUE</code>, the linetype of the logistic calibration curve. Default is <code>1</code>.</p></dd>


<dt>col.log</dt>
<dd><p>if <code>logistic.cal=TRUE</code>, the color of the logistic calibration curve. Default is <code>"black"</code>.</p></dd>


<dt>lwd.log</dt>
<dd><p>if <code>logistic.cal=TRUE</code>, the line width of the logistic calibration curve. Default is <code>1</code>.</p></dd>


<dt>xlab</dt>
<dd><p>x-axis label, default is <code>"Predicted Probability"</code>.</p></dd>


<dt>ylab</dt>
<dd><p>y-axis label, default is <code>"Observed proportion"</code>.</p></dd>


<dt>xlim, ylim</dt>
<dd><p>numeric vectors of length 2, giving the x and y coordinates ranges (see <code><a href="https://rdrr.io/r/graphics/plot.window.html" class="external-link">plot.window</a></code>)</p></dd>


<dt>m</dt>
<dd><p>If grouped proportions are desired, average no. observations per group</p></dd>


<dt>g</dt>
<dd><p>If grouped proportions are desired, number of quantile groups</p></dd>


<dt>cuts</dt>
<dd><p>If grouped proportions are desired, actual cut points for constructing
intervals, e.g. <code>c(0,.1,.8,.9,1)</code> or <code>seq(0,1,by=.2)</code></p></dd>


<dt>emax.lim</dt>
<dd><p>Vector containing lowest and highest predicted probability over which to
compute <code>Emax</code>.</p></dd>


<dt>legendloc</dt>
<dd><p>if <code>pl=TRUE</code>, list with components <code>x,y</code> or vector <code>c(x,y)</code> for bottom right corner of legend for
curves and points. Default is <code>c(.50, .27)</code> scaled to lim. Use <code>locator(1)</code> to use the mouse, <code>FALSE</code> to suppress legend.</p></dd>


<dt>statloc</dt>
<dd><p>the "abc" of model performance (Steyerberg et al., 2011)-calibration intercept, calibration slope,
and c statistic-will be added to the plot, using statloc as the upper left corner of a box (default is c(0,.85).
You can specify a list or a vector. Use locator(1) for the mouse, <code>FALSE</code> to suppress statistics. This is plotted after
the curve legends.</p></dd>


<dt>dostats</dt>
<dd><p>specifies whether and which performance measures are shown in the figure.
<code>TRUE</code> shows the <code>"abc"</code> of model performance (Steyerberg et al., 2011): calibration intercept, calibration slope,
 and c-statistic. <code>TRUE</code> is default.
 <code>FALSE</code> suppresses the presentation of statistics in the figure. A <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> list of specific stats shows the specified
 stats. The key stats which are also mentioned in this paper are <code>"C (ROC)"</code> for the c statistic, <code>"Intercept"</code> for the
 calibration intercept, <code>"Slope"</code> for the calibration slope, and <code>"ECI"</code> for the estimated calibration index
 (Van Hoorde et al, 2015). The full list of possible statistics is taken from <code><a href="https://rdrr.io/pkg/rms/man/val.prob.html" class="external-link">val.prob</a></code>
 and augmented with the estimated calibration index: <code>"Dxy", "C (ROC)", "R2", "D", "D:Chi-sq", "D:p", "U", "U:Chi-sq",
  "U:p", "Q", "Brier", "Intercept", "Slope", "Emax", "Brier scaled", "Eavg", "ECI"</code>. These statistics are always returned by the function.</p></dd>


<dt>cl.level</dt>
<dd><p>if <code>dostats=TRUE</code>, the confidence level for the calculation of the confidence intervals of the calibration intercept,
calibration slope and c-statistic. Default is <code>0.95</code>.</p></dd>


<dt>method.ci</dt>
<dd><p>method to calculate the confidence interval of the c-statistic. The argument is passed to <code><a href="auc.nonpara.mw.html">auc.nonpara.mw</a></code> from
the auRoc-package and possible methods to compute the confidence interval are <code>"newcombe"</code>, <code>"pepe"</code>, <code>"delong"</code> or
<code>"jackknife"</code>. Bootstrap-based methods are not available. The default method is <code>"pepe"</code> and here, the confidence interval is
the logit-transformation-based confidence interval as documented in Qin and Hotilovac (2008). See <code><a href="auc.nonpara.mw.html">auc.nonpara.mw</a></code> for
more information on the other methods.</p></dd>


<dt>roundstats</dt>
<dd><p>specifies the number of decimals to which the statistics are rounded when shown in the plot. Default is 2.</p></dd>


<dt>riskdist</dt>
<dd><p>Use <code>"calibrated"</code> to plot the relative frequency distribution of
calibrated probabilities after dividing into 101 bins from <code>lim[1]</code> to
<code>lim[2]</code>.
Set to <code>"predicted"</code> (the default as of rms 4.5-1) to use raw assigned risk, <code>FALSE</code> to omit risk distribution.
Values are scaled so that highest bar is <code>0.15*(lim[2]-lim[1])</code>.</p></dd>


<dt>cex, cex.leg</dt>
<dd><p>controls the font size of the statistics (<code>cex</code>) or plot legend (<code>cex.leg</code>). Default is 0.75</p></dd>


<dt>connect.group</dt>
<dd><p>Defaults to <code>FALSE</code> to only represent group fractions as triangles.
Set to <code>TRUE</code> to also connect with a solid line.</p></dd>


<dt>connect.smooth</dt>
<dd><p>Defaults to <code>TRUE</code> to draw smoothed estimates using a line. Set to <code>FALSE</code> to instead use dots at individual estimates</p></dd>


<dt>g.group</dt>
<dd><p>number of quantile groups to use when <code>group</code> is given and variable is
numeric.</p></dd>


<dt>evaluate</dt>
<dd><p>number of points at which to store the <code>lowess</code>-calibration curve.
Default is 100.  If there are more than <code>evaluate</code> unique predicted
probabilities, <code>evaluate</code> equally-spaced quantiles of the unique
predicted probabilities, with linearly interpolated calibrated values,
are retained for plotting (and stored in the object returned by
<code>val.prob</code>.</p></dd>


<dt>nmin</dt>
<dd><p>applies when <code>group</code> is given.  When <code>nmin</code> \(&gt; 0\), <code>val.prob</code> will not
store coordinates of smoothed calibration curves in the outer tails,
where there are fewer than <code>nmin</code> raw observations represented in
those tails.  If for example <code>nmin</code>=50, the <code>plot</code> function will only
plot the estimated calibration curve from \(a\) to \(b\), where there are
50 subjects with predicted probabilities \(&lt; a\) and \(&gt; b\).
<code>nmin</code> is ignored when computing accuracy statistics.</p></dd>


<dt>d0lab, d1lab</dt>
<dd><p>controls the labels for events and non-events (i.e. outcome y) for the histograms.
Defaults are <code>d1lab="1"</code> for events and <code>d0lab="0"</code> for non-events.</p></dd>


<dt>cex.d01</dt>
<dd><p>controls the size of the labels for events and non-events. Default is 0.7.</p></dd>


<dt>dist.label</dt>
<dd><p>controls the horizontal position of the labels for events and non-events. Default is 0.04.</p></dd>


<dt>line.bins</dt>
<dd><p>controls the horizontal (y-axis) position of the histograms. Default is -0.05.</p></dd>


<dt>dist.label2</dt>
<dd><p>controls the vertical distance between the labels for events and non-events. Default is 0.03.</p></dd>


<dt>cutoff</dt>
<dd><p>puts an arrow at the specified risk cut-off(s). Default is none.</p></dd>


<dt>las</dt>
<dd><p>controls whether y-axis values are shown horizontally (1) or vertically (0).</p></dd>


<dt>length.seg</dt>
<dd><p>controls the length of the histogram lines. Default is <code>1</code>.</p></dd>


<dt>y.intersp</dt>
<dd><p>character interspacing for vertical line distances of the legend (<code><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></code>)</p></dd>


<dt>lty.ideal</dt>
<dd><p>linetype of the ideal line. Default is <code>1</code>.</p></dd>


<dt>col.ideal</dt>
<dd><p>controls the color of the ideal line on the plot. Default is <code>"red"</code>.</p></dd>


<dt>lwd.ideal</dt>
<dd><p>controls the line width of the ideal line on the plot. Default is <code>1</code>.</p></dd>


<dt>allowPerfectPredictions</dt>
<dd><p>Logical, indicates whether perfect predictions (i.e. values of either 0 or 1) are allowed. Default is <code>FALSE</code>, since we transform
the predictions using the logit transformation to calculate the calibration measures. In case of 0 and 1, this results in minus infinity and infinity, respectively. if
<code>allowPerfectPredictions = TRUE</code>, 0 and 1 are replaced by 1e-8 and 1 - 1e-8, respectively.</p></dd>


<dt>...</dt>
<dd><p>arguments to be passed to <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code>, see <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of type <code>CalibrationCurve</code> with the following slots:</p>
<dl><dt>call</dt>
<dd><p>the matched call.</p></dd>


<dt>stats</dt>
<dd><p>a vector containing performance measures of calibration.</p></dd>


<dt>cl.level</dt>
<dd><p>the confidence level used.</p></dd>


<dt>Calibration</dt>
<dd><p>contains the calibration intercept and slope, together with their confidence intervals.</p></dd>


<dt>Cindex</dt>
<dd><p>the value of the c-statistic, together with its confidence interval.</p></dd>


<dt>warningMessages</dt>
<dd><p>if any, the warning messages that were printed while running the function.</p></dd>


<dt>CalibrationCurves</dt>
<dd><p>The coordinates for plotting the calibration curves.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When using the predicted probabilities of an uninformative model (i.e. equal probabilities for all observations), the model has no predictive value.
 Consequently, where applicable, the value of the performance measure corresponds to the worst possible theoretical value. For the ECI, for example, this equals 1 (Edlinger et al., 2022).</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>In order to make use (of the functions) of the package auRoc, the user needs to install JAGS. However, since our package only uses the
<code>auc.nonpara.mw</code> function which does not depend on the use of JAGS, we therefore copied the code and slightly adjusted it when
<code>method="pepe"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Edlinger, M, van Smeden, M, Alber, HF, Wanitschek, M, Van Calster, B. (2022). Risk prediction models for discrete ordinal outcomes: Calibration and the impact of the proportional odds assumption. <em>Statistics in Medicine</em>, <b>41( 8)</b>, pp. 1334– 1360</p>
<p>Qin, G., &amp; Hotilovac, L. (2008). Comparison of non-parametric confidence intervals for the area under the ROC curve of a continuous-scale diagnostic test. <em>Statistical Methods in Medical Research</em>, <b>17(2)</b>, pp. 207-21</p>
<p>Steyerberg, E.W., Van Calster, B., Pencina, M.J. (2011). Performance measures for prediction models and markers : evaluation of predictions and classifications. <em>Revista Espanola de Cardiologia</em>, <b>64(9)</b>, pp. 788-794</p>
<p>Van Calster, B., Nieboer, D., Vergouwe, Y., De Cock, B., Pencina M., Steyerberg E.W. (2016). A calibration hierarchy for risk models was defined: from utopia to empirical data. <em>Journal of Clinical Epidemiology</em>, <b>74</b>, pp. 167-176</p>
<p>Van Hoorde, K., Van Huffel, S., Timmerman, D., Bourne, T., Van Calster, B. (2015). A spline-based tool to assess and visualize the calibration of multiclass risk predictions. <em>Journal of Biomedical Informatics</em>, <b>54</b>, pp. 283-93</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load package</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bavodc.github.io/websiteCalibrationCurves/" class="external-link">CalibrationCurves</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1783</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate training data</span></span></span>
<span class="r-in"><span><span class="va">X</span>      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5e2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p0true</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">linkinv</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1.2</span>, <span class="op">-</span><span class="fl">0.75</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span>      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">5e2</span>, <span class="fl">1</span>, <span class="va">p0true</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Df</span>     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit logistic model</span></span></span>
<span class="r-in"><span><span class="va">FitLog</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/rms/man/lrm.html" class="external-link">lrm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">Df</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate validation data</span></span></span>
<span class="r-in"><span><span class="va">Xval</span>   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5e2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p0true</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">linkinv</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Xval</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1.2</span>, <span class="op">-</span><span class="fl">0.75</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">yval</span>   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">5e2</span>, <span class="fl">1</span>, <span class="va">p0true</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Pred</span>   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">linkinv</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Xval</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">FitLog</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Default calibration plot</span></span></span>
<span class="r-in"><span><span class="fu">val.prob.ci.2</span><span class="op">(</span><span class="va">Pred</span>, <span class="va">yval</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="val.prob.ci.2-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> val.prob.ci.2(p = Pred, y = yval)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 95% confidence interval is given for the calibration intercept, calibration slope and c-statistic. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Dxy      C (ROC)           R2            D     D:Chi-sq          D:p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.60048690   0.80024345   0.35491505   0.30737619 154.68809420   0.00000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            U     U:Chi-sq          U:p            Q        Brier    Intercept </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.01384033   8.92016298   0.01156142   0.29353586   0.18549917   0.18828469 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Slope         Emax Brier scaled         Eavg          ECI </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.79397043   0.08026282   0.25724275   0.05093656   0.37394083 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Adding logistic calibration curves and other additional features</span></span></span>
<span class="r-in"><span><span class="fu">val.prob.ci.2</span><span class="op">(</span><span class="va">Pred</span>, <span class="va">yval</span>, CL.smooth <span class="op">=</span> <span class="cn">TRUE</span>, logistic.cal <span class="op">=</span> <span class="cn">TRUE</span>, lty.log <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span> col.log <span class="op">=</span> <span class="st">"red"</span>, lwd.log <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="val.prob.ci.2-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> val.prob.ci.2(p = Pred, y = yval, CL.smooth = TRUE, logistic.cal = TRUE, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lty.log = 2, col.log = "red", lwd.log = 1.5)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 95% confidence interval is given for the calibration intercept, calibration slope and c-statistic. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Dxy      C (ROC)           R2            D     D:Chi-sq          D:p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.60048690   0.80024345   0.35491505   0.30737619 154.68809420   0.00000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            U     U:Chi-sq          U:p            Q        Brier    Intercept </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.01384033   8.92016298   0.01156142   0.29353586   0.18549917   0.18828469 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Slope         Emax Brier scaled         Eavg          ECI </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.79397043   0.08026282   0.25724275   0.05093656   0.37394083 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">val.prob.ci.2</span><span class="op">(</span><span class="va">Pred</span>, <span class="va">yval</span>, CL.smooth <span class="op">=</span> <span class="cn">TRUE</span>, logistic.cal <span class="op">=</span> <span class="cn">TRUE</span>, lty.log <span class="op">=</span> <span class="fl">9</span>,</span></span>
<span class="r-in"><span>col.log <span class="op">=</span> <span class="st">"red"</span>, lwd.log <span class="op">=</span> <span class="fl">1.5</span>, col.ideal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colors.html" class="external-link">colors</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span>, lwd.ideal <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="val.prob.ci.2-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> val.prob.ci.2(p = Pred, y = yval, CL.smooth = TRUE, logistic.cal = TRUE, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lty.log = 9, col.log = "red", lwd.log = 1.5, col.ideal = colors()[10], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lwd.ideal = 0.5)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 95% confidence interval is given for the calibration intercept, calibration slope and c-statistic. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Dxy      C (ROC)           R2            D     D:Chi-sq          D:p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.60048690   0.80024345   0.35491505   0.30737619 154.68809420   0.00000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            U     U:Chi-sq          U:p            Q        Brier    Intercept </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.01384033   8.92016298   0.01156142   0.29353586   0.18549917   0.18828469 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Slope         Emax Brier scaled         Eavg          ECI </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.79397043   0.08026282   0.25724275   0.05093656   0.37394083 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Bavo De Cock Campo.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

